/*C1*/SET SCHEMA SYSTEM_LOBS
INSERT INTO BLOCKS VALUES(0,2147483647,0)
COMMIT
/*C2*/SET SCHEMA PUBLIC
DROP TABLE Role IF EXISTS
DROP TABLE USER IF EXISTS
DROP TABLE Account IF EXISTS
DROP TABLE Account_Domain IF EXISTS
DROP TABLE User_Role IF EXISTS
DROP TABLE User_Password IF EXISTS
DROP TABLE User_Attribute IF EXISTS
DROP TABLE Address IF EXISTS
CREATE TABLE Role (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000aname varchar(32),\u000adescription varchar(255),\u000aPRIMARY KEY (id),\u000aUNIQUE (name)\u000a)
CREATE TABLE Address (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000aname varchar(128),\u000astreet1 varchar(128),\u000astreet2 varchar(128),\u000acity varchar(128),\u000aregion varchar(128),\u000acountry varchar(3),\u000apostal varchar(12),\u000aPRIMARY KEY (id),\u000a)
CREATE TABLE Account (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000aname varchar(128),\u000aaddressId INTEGER,\u000assoEnabled BOOLEAN DEFAULT false,\u000assoIdpId varchar(128),\u000aPRIMARY KEY (id),\u000aUNIQUE (name),\u000aCONSTRAINT fk_account_address FOREIGN KEY (addressId) REFERENCES Address (id)\u000a)
CREATE TABLE Account_Domain (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000aaccountId INTEGER,\u000adomain varchar(128),\u000aUNIQUE (domain)\u000a)
CREATE TABLE User (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000afirstName varchar(128),\u000alastName varchar(128),\u000aemail varchar(128),\u000aaccountId INTEGER,\u000aaddressId INTEGER,\u000aPRIMARY KEY (id),\u000aUNIQUE (email),\u000aCONSTRAINT fk_user_account FOREIGN KEY (accountId) REFERENCES Account (id),\u000aCONSTRAINT fk_user_address FOREIGN KEY (addressId) REFERENCES Address (id)\u000a)
CREATE TABLE User_Password(\u000auserId INTEGER,\u000apassword varchar(32),\u000aUNIQUE (userId)\u000a)
CREATE TABLE User_Role (\u000auserId INTEGER,\u000aroleId INTEGER,\u000aPRIMARY KEY (userId,roleId)\u000a)
CREATE TABLE User_Attribute (\u000aid INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) NOT NULL,\u000auserId INTEGER,\u000aattrKey varchar(128),\u000aattrValue varchar(255),\u000aPRIMARY KEY(id)\u000a)
INSERT INTO ROLE VALUES(1,'super','Super User. Limited to MyLittlePony employees')
COMMIT
INSERT INTO ROLE VALUES(2,'admin','Account administrator')
COMMIT
INSERT INTO ROLE VALUES(3,'user','Account user')
COMMIT
INSERT INTO ACCOUNT VALUES(1,'mylittlepony.com',NULL,FALSE,NULL)
COMMIT
INSERT INTO ADDRESS VALUES(1,'General','100 Wall St.','Suite 100','Gotham','NY','US','12345')
COMMIT
DELETE FROM ACCOUNT WHERE ID=1
INSERT INTO ACCOUNT VALUES(1,'mylittlepony.com',1,FALSE,NULL)
COMMIT
INSERT INTO ACCOUNT_DOMAIN VALUES(1,1,'mylittlepony.com')
COMMIT
INSERT INTO ACCOUNT VALUES(2,'Customer',NULL,FALSE,NULL)
COMMIT
INSERT INTO ADDRESS VALUES(2,'General','2600 E. 52nd St.','Suite 270','Gotham','NY','US','12345')
COMMIT
DELETE FROM ACCOUNT WHERE ID=2
INSERT INTO ACCOUNT VALUES(2,'Customer',2,FALSE,NULL)
COMMIT
INSERT INTO ACCOUNT_DOMAIN VALUES(2,2,'customer.com')
COMMIT
INSERT INTO USER VALUES(1,'David','Skyberg','dskyberg@mylittlepony.com',1,NULL)
COMMIT
INSERT INTO USER_PASSWORD VALUES(1,'2Federate')
COMMIT
INSERT INTO USER_ROLE VALUES(1,1)
COMMIT
INSERT INTO USER_ROLE VALUES(1,2)
COMMIT
INSERT INTO USER_ROLE VALUES(1,3)
COMMIT
INSERT INTO USER VALUES(2,'Joe','Test','joe@customer.com',2,NULL)
COMMIT
INSERT INTO USER_PASSWORD VALUES(2,'2Federate')
COMMIT
INSERT INTO USER_ROLE VALUES(2,2)
COMMIT
INSERT INTO USER_ROLE VALUES(2,3)
COMMIT
INSERT INTO USER VALUES(3,'Sue','Test','sue@customer.com',2,NULL)
COMMIT
INSERT INTO USER_PASSWORD VALUES(3,'2Federate')
COMMIT
INSERT INTO USER_ROLE VALUES(3,3)
COMMIT
DISCONNECT
